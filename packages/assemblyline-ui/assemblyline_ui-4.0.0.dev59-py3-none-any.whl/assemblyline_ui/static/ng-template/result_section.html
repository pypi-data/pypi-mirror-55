<div class="part" ng-show="sections">
	<section ng-repeat="sec in sections" class="section" ng-class="{'highlight': hasHighlightedTags(tagTypeList(sectionTags(sec)))}">
		<div class="result_title indent_{{sec.depth}}" data-toggle="collapse" data-target="#{{''+parent+$index}}" ng-class="{'highlight': hasHighlightedTags(tagTypeList(sectionTags(sec)))}"><span class="text-info"><strong><span class="{{sec.classification | class_text_color }}" ng-if="sec.classification">({{sec.classification | class_sm}})</span>&nbsp;<span class="{{sec.heuristic.score | score_color}}">{{sec.heuristic.score}}</span></strong></span><span class="text-muted">::&nbsp;</span><span replace-tags  data="sec.title_text" tags="tagTypeList(sec.tags)"></span>&nbsp;&nbsp;<a ng-show="sec.heuristic" href='/search.html?query=result.sections.heuristic.heur_id:"{{sec.heuristic.heur_id}}"' class="text-muted clickable_color glyphicon glyphicon-search" ng-click="$event.stopPropagation();"></a></div>
		<div id="{{parent+$index}}" class="indent_{{sec.depth}} collapse in">
			<div ng-if="sec.body_format=='TEXT'" class="result_body" ng-show="sec.body"><div replace-tags data="sec.body" tags="tagTypeList(sec.tags)"></div></div>
			<pre ng-if="sec.body_format=='MEMORY_DUMP'" class="result_body" ng-show="sec.body">{{sec.body}}</pre>
			<div graph-section ng-if="sec.body_format=='GRAPH_DATA'" class="result_body" ng-show="sec.body" graph-data="{{sec.body}}"></div>
			<div url-section ng-if="sec.body_format=='URL'" class="result_body" ng-show="sec.body" url-data="{{sec.body}}"></div>
            <div ng-if="sec.body_format=='JSON'" class="result_body"><div ng-jsoneditor ng-model="sec.body" options="{'mode': 'view'}" style="width: 100%; height: 300px;"></div></div>
			<div kv-section ng-if="sec.body_format=='KEY_VALUE'" class="result_body" ng-show="sec.body" kv-data="{{sec.body}}"></div>

            <div style="margin-left: 4em; margin-bottom: 1em;" >
				<span ng-if="sec.heuristic.attack_id" title="ATT&CK Pattern: {{sec.heuristic.attack_pattern}} [{{sec.heuristic.attack_id}}]" class="label label-tag" style="cursor: pointer;" ng-class="{'label-nolight': !isHighlighted('attack_pattern', sec.heuristic.attack_id), 'label-highlight': isHighlighted('attack_pattern', sec.heuristic.attack_id)}" ng-click="trigger_highlight('attack_pattern', sec.heuristic.attack_id);">[ATT&CK] {{sec.heuristic.attack_pattern | breakableStr }}<a href='/search.html?query=result.sections.heuristic.attack_id:"{{uri_encode(sec.heuristic.attack_id)}}"' class="search_tag clickable_color glyphicon glyphicon-search" ng-click="$event.stopPropagation();"></a></span>
				<span title="{{tag.type}}: {{tag.value}}" class="label label-tag" style="cursor: pointer;" ng-repeat="tag in sec.tags | orderBy:'type'" ng-class="{'label-nolight': !isHighlighted(tag.type, tag.value), 'label-highlight': isHighlighted(tag.type, tag.value)}" ng-click="trigger_highlight(tag.type, tag.value);" >[{{tag.short_type.toUpperCase()}}] {{tag.value | breakableStr }}<a href='/search.html?query=result.sections.tags.{{tag.type}}:"{{uri_encode(tag.value)}}"' class="search_tag clickable_color glyphicon glyphicon-search" ng-click="$event.stopPropagation();"></a></span>
			</div>
		</div>
	</section>
</div>

