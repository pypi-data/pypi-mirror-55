
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pysap.SAPLPS module &#8212; pysap 0.1.17 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pysap.SAPMS module" href="pysap.SAPMS.html" />
    <link rel="prev" title="pysap.SAPIGS module" href="pysap.SAPIGS.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-pysap.SAPLPS">
<span id="pysap-saplps-module"></span><h1>pysap.SAPLPS module<a class="headerlink" href="#module-pysap.SAPLPS" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher">
<em class="property">class </em><code class="descclassname">pysap.SAPLPS.</code><code class="descname">SAP_LPS_Cipher</code><a class="reference internal" href="../_modules/pysap/SAPLPS.html#SAP_LPS_Cipher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">scapy.packet.Packet</span></code></p>
<p>SAP LPS cipher packet. This is the data stored inside an LPS encrypted blob
(credential or PSE file). It contains all the required data to decrypt and validate
the stored context.</p>
<p>Context length should be &lt;28h
Restriction length should be &lt;400h</p>
<dl class="attribute">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher.LPS_DPAPI">
<code class="descname">LPS_DPAPI</code><em class="property"> = 1</em><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher.LPS_DPAPI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher.LPS_FALLBACK">
<code class="descname">LPS_FALLBACK</code><em class="property"> = 0</em><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher.LPS_FALLBACK" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher.LPS_TPM">
<code class="descname">LPS_TPM</code><em class="property"> = 2</em><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher.LPS_TPM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher.aliastypes">
<code class="descname">aliastypes</code><em class="property"> = [&lt;class 'pysap.SAPLPS.SAP_LPS_Cipher'&gt;, &lt;class 'scapy.packet.Packet'&gt;]</em><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher.aliastypes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher.decrypt">
<code class="descname">decrypt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPLPS.html#SAP_LPS_Cipher.decrypt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher.decrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypt a blob using LPS. Implements FALLBACK and DP methods to derive
or obtain the encryption key from the one stored in the PSE/credential file and then uses
that encryption key to decrypt the credential using the AES cipher.</p>
<p>LPS-protected PSEs/credentials are verified with both a CRC32 checksum and an HMAC.
Validation of the checksum and HMAC is not implemented.</p>
<p>Requires the cryptography library installed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">decrypted object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">string</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>Exception</strong> – if the cryptography library is not available</li>
<li><strong>NotImplemented</strong> – if the LPS method is not implemented</li>
<li><a class="reference internal" href="#pysap.SAPLPS.SAP_LPS_Decryption_Error" title="pysap.SAPLPS.SAP_LPS_Decryption_Error"><strong>SAP_LPS_Decryption_Error</strong></a> – if there’s an error decrypting the object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher.decrypt_encryption_key_dpapi">
<code class="descname">decrypt_encryption_key_dpapi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPLPS.html#SAP_LPS_Cipher.decrypt_encryption_key_dpapi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher.decrypt_encryption_key_dpapi" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypts the encryption key using the DP API. The key is encrypted using
the DP API without any additional entropy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Encryption key decrypted</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher.decrypt_encryption_key_fallback">
<code class="descname">decrypt_encryption_key_fallback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPLPS.html#SAP_LPS_Cipher.decrypt_encryption_key_fallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher.decrypt_encryption_key_fallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypts the encryption key using the FALLBACK method. In this method, the
context string, usually “CredEncryption” or “PSEEncryption”, is encrypted using
a derivation of a fixed key hardcoded in CommonCryptoLib, and used as key to
encrypt the actual encryption key used in the file with the AES cipher.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Encryption key decrypted</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher.decrypt_encryption_key_tpm">
<code class="descname">decrypt_encryption_key_tpm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPLPS.html#SAP_LPS_Cipher.decrypt_encryption_key_tpm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher.decrypt_encryption_key_tpm" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypts the encryption key using the TPM method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Encryption key decrypted</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher.fields_desc">
<code class="descname">fields_desc</code><em class="property"> = [&lt;Field (SAP_LPS_Cipher).version&gt;, &lt;Field (SAP_LPS_Cipher).lps_type&gt;, &lt;Field (SAP_LPS_Cipher).context_length&gt;, &lt;Field (SAP_LPS_Cipher).context&gt;, &lt;Field (SAP_LPS_Cipher).restriction_length&gt;, &lt;Field (SAP_LPS_Cipher).restriction&gt;, &lt;Field (SAP_LPS_Cipher).encrypted_key_length&gt;, &lt;Field (SAP_LPS_Cipher).encrypted_key&gt;, &lt;Field (SAP_LPS_Cipher).unknown_length&gt;, &lt;Field (SAP_LPS_Cipher).unknown&gt;, &lt;Field (SAP_LPS_Cipher).encrypted_data_length&gt;, &lt;Field (SAP_LPS_Cipher).encrypted_data&gt;, &lt;Field (SAP_LPS_Cipher).hmac&gt;, &lt;Field (SAP_LPS_Cipher).checksum&gt;]</em><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher.fields_desc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pysap.SAPLPS.SAP_LPS_Cipher.lps_types">
<code class="descname">lps_types</code><em class="property"> = {0: 'FALLBACK', 1: 'DPAPI', 2: 'TPM'}</em><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Cipher.lps_types" title="Permalink to this definition">¶</a></dt>
<dd><p>LPS types</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="pysap.SAPLPS.SAP_LPS_Decryption_Error">
<em class="property">exception </em><code class="descclassname">pysap.SAPLPS.</code><code class="descname">SAP_LPS_Decryption_Error</code><a class="reference internal" href="../_modules/pysap/SAPLPS.html#SAP_LPS_Decryption_Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPLPS.SAP_LPS_Decryption_Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="data">
<dt id="pysap.SAPLPS.cred_key_lps_fallback">
<code class="descclassname">pysap.SAPLPS.</code><code class="descname">cred_key_lps_fallback</code><em class="property"> = '\xe7j\xd2\xceK\xa7\xc7\x9e\xf9y_\xa8.n\xaa\x1dv\x02.\xcd\xd7t8Q'</em><a class="headerlink" href="#pysap.SAPLPS.cred_key_lps_fallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixed key embedded in CommonCryptoLib for encrypted credentials using LPS in fallback mode</p>
</dd></dl>

<dl class="data">
<dt id="pysap.SAPLPS.lps_encryption_key_decryptor">
<code class="descclassname">pysap.SAPLPS.</code><code class="descname">lps_encryption_key_decryptor</code><em class="property"> = {0: &lt;unbound method SAP_LPS_Cipher.decrypt_encryption_key_fallback&gt;, 1: &lt;unbound method SAP_LPS_Cipher.decrypt_encryption_key_dpapi&gt;, 2: &lt;unbound method SAP_LPS_Cipher.decrypt_encryption_key_tpm&gt;}</em><a class="headerlink" href="#pysap.SAPLPS.lps_encryption_key_decryptor" title="Permalink to this definition">¶</a></dt>
<dd><p>LPS encryption key decryptor functions</p>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pysap</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/index.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fileformats/index.html">File formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Example scripts</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">Development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Interface</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pysap.html">pysap package</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pysap.html#pysap">pysap</a></li>
<li class="toctree-l3"><a class="reference internal" href="pysap.html#subpackages">Subpackages</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="pysap.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pysapcompress.html">pysapcompress library</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Developer Interface</a><ul>
  <li><a href="pysap.html">pysap package</a><ul>
      <li>Previous: <a href="pysap.SAPIGS.html" title="previous chapter">pysap.SAPIGS module</a></li>
      <li>Next: <a href="pysap.SAPMS.html" title="next chapter">pysap.SAPMS module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;SECUREAUTH LABS. Copyright (C) 2019 SecureAuth Corporation. All rights reserved..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.9</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/api/pysap.SAPLPS.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>