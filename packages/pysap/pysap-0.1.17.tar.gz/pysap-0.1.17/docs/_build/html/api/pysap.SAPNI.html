
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pysap.SAPNI module &#8212; pysap 0.1.17 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pysap.SAPPSE module" href="pysap.SAPPSE.html" />
    <link rel="prev" title="pysap.SAPMS module" href="pysap.SAPMS.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-pysap.SAPNI">
<span id="pysap-sapni-module"></span><h1>pysap.SAPNI module<a class="headerlink" href="#module-pysap.SAPNI" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pysap.SAPNI.SAPNI">
<em class="property">class </em><code class="descclassname">pysap.SAPNI.</code><code class="descname">SAPNI</code><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">scapy.packet.Packet</span></code></p>
<p>SAP NI (Network Interface) packet</p>
<p>This packet is used for craft Network Interface packets. It serves only
as a container for packets in the different protocols. As this protocol
is used by different protocols and the only way to differentiate each one
is by the TCP port used, each script using the NI protocol must bind the
respective layer with the respective protocol.</p>
<p>For example, a script using the SAP Diag protocol must include the
following binds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bind_layers</span><span class="p">(</span><span class="n">SAPNI</span><span class="p">,</span>      <span class="n">SAPDiag</span><span class="p">,</span> <span class="p">)</span>
<span class="n">bind_layers</span><span class="p">(</span><span class="n">SAPNI</span><span class="p">,</span>      <span class="n">SAPDiagDP</span><span class="p">,</span> <span class="p">)</span>
<span class="n">bind_layers</span><span class="p">(</span><span class="n">SAPDiagDP</span><span class="p">,</span>  <span class="n">SAPDiag</span><span class="p">,</span> <span class="p">)</span>
<span class="n">bind_layers</span><span class="p">(</span><span class="n">SAPDiag</span><span class="p">,</span>    <span class="n">SAPDiagItem</span><span class="p">,</span> <span class="p">)</span>
<span class="n">bind_layers</span><span class="p">(</span><span class="n">SAPDiagItem</span><span class="p">,</span><span class="n">SAPDiagItem</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="pysap.SAPNI.SAPNI.SAPNI_PING">
<code class="descname">SAPNI_PING</code><em class="property"> = 'NI_PING\x00'</em><a class="headerlink" href="#pysap.SAPNI.SAPNI.SAPNI_PING" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Cvar:</th><td class="field-body">Constant for keep-alive request messages (NI_PING)</td>
</tr>
<tr class="field-even field"><th class="field-name">Type:</th><td class="field-body">C{string}</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pysap.SAPNI.SAPNI.SAPNI_PONG">
<code class="descname">SAPNI_PONG</code><em class="property"> = 'NI_PONG\x00'</em><a class="headerlink" href="#pysap.SAPNI.SAPNI.SAPNI_PONG" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Cvar:</th><td class="field-body">Constant for keep-alive response messages (NI_PONG)</td>
</tr>
<tr class="field-even field"><th class="field-name">Type:</th><td class="field-body">C{string}</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pysap.SAPNI.SAPNI.aliastypes">
<code class="descname">aliastypes</code><em class="property"> = [&lt;class 'pysap.SAPNI.SAPNI'&gt;, &lt;class 'scapy.packet.Packet'&gt;]</em><a class="headerlink" href="#pysap.SAPNI.SAPNI.aliastypes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pysap.SAPNI.SAPNI.fields_desc">
<code class="descname">fields_desc</code><em class="property"> = [&lt;Field (SAPNI).length&gt;]</em><a class="headerlink" href="#pysap.SAPNI.SAPNI.fields_desc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pysap.SAPNI.SAPNIClient">
<em class="property">class </em><code class="descclassname">pysap.SAPNI.</code><code class="descname">SAPNIClient</code><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIClient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIClient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stub class for a client connecting to the SAP NI server.</p>
</dd></dl>

<dl class="class">
<dt id="pysap.SAPNI.SAPNIProxy">
<em class="property">class </em><code class="descclassname">pysap.SAPNI.</code><code class="descname">SAPNIProxy</code><span class="sig-paren">(</span><em>bind_address</em>, <em>bind_port</em>, <em>remote_address</em>, <em>remote_port</em>, <em>handler</em>, <em>backlog=5</em>, <em>keep_alive=True</em>, <em>options=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIProxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIProxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>SAP NI Proxy</p>
<p>It works by setting a listener <a class="reference internal" href="#pysap.SAPNI.SAPNIStreamSocket" title="pysap.SAPNI.SAPNIStreamSocket"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIStreamSocket</span></code></a> and dispatching client’s
requests to a given handler class.</p>
<dl class="docutils">
<dt>Example usage::</dt>
<dd>proxy = SAPNIProxy(local_host, local_port, remote_host, remote_port, handler_class)
proxy.handle_connection()</dd>
</dl>
<dl class="method">
<dt id="pysap.SAPNI.SAPNIProxy.handle_connection">
<code class="descname">handle_connection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIProxy.handle_connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIProxy.handle_connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until a connection is received from the listener and handle that
client using the provided handler class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the handler instance handling the request</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pysap.SAPNI.SAPNIProxyHandler" title="pysap.SAPNI.SAPNIProxyHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIProxyHandler</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIProxy.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIProxy.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIProxy.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop the proxy by closing the listener socket.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pysap.SAPNI.SAPNIProxyHandler">
<em class="property">class </em><code class="descclassname">pysap.SAPNI.</code><code class="descname">SAPNIProxyHandler</code><span class="sig-paren">(</span><em>client</em>, <em>server</em>, <em>options=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIProxyHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIProxyHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>SAP NI Proxy Handler</p>
<p>Handles NI packets. Works spawning one thread for processing data coming
from each pair of client/server.</p>
<dl class="method">
<dt id="pysap.SAPNI.SAPNIProxyHandler.process_client">
<code class="descname">process_client</code><span class="sig-paren">(</span><em>packet</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIProxyHandler.process_client"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIProxyHandler.process_client" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called each time a packet arrives from the client.
It must return a packet in the same layer (<a class="reference internal" href="#pysap.SAPNI.SAPNI" title="pysap.SAPNI.SAPNI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNI</span></code></a>). Stub method
to be overloaded in subclasses.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>packet</strong> (<em>Packet</em>) – the packet to be processed</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIProxyHandler.process_server">
<code class="descname">process_server</code><span class="sig-paren">(</span><em>packet</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIProxyHandler.process_server"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIProxyHandler.process_server" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called each time a packet arrives from the server.
It must return a packet in the same layer (<a class="reference internal" href="#pysap.SAPNI.SAPNI" title="pysap.SAPNI.SAPNI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNI</span></code></a>). Stub method
to be overloaded in subclasses.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>packet</strong> (<em>Packet</em>) – the packet to be processed</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIProxyHandler.recv_send">
<code class="descname">recv_send</code><span class="sig-paren">(</span><em>local</em>, <em>remote</em>, <em>process</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIProxyHandler.recv_send"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIProxyHandler.recv_send" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives data from one socket connection, process it and send to the
remote connection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local</strong> (<a class="reference internal" href="#pysap.SAPNI.SAPNIStreamSocket" title="pysap.SAPNI.SAPNIStreamSocket"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIStreamSocket</span></code></a>) – the local socket</li>
<li><strong>remote</strong> (<a class="reference internal" href="#pysap.SAPNI.SAPNIStreamSocket" title="pysap.SAPNI.SAPNIStreamSocket"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIStreamSocket</span></code></a>) – the remote socket</li>
<li><strong>process</strong> (<em>function</em>) – the function that process the incoming data</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIProxyHandler.stop_workers">
<code class="descname">stop_workers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIProxyHandler.stop_workers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIProxyHandler.stop_workers" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop the processor workers</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pysap.SAPNI.SAPNIServer">
<em class="property">class </em><code class="descclassname">pysap.SAPNI.</code><code class="descname">SAPNIServer</code><span class="sig-paren">(</span><em>server_address</em>, <em>RequestHandlerClass</em>, <em>bind_and_activate=True</em>, <em>socket_cls=None</em>, <em>keep_alive=True</em>, <em>base_cls=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIServer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SocketServer.TCPServer</span></code></p>
<p>Base SAP NI Server class.</p>
<p>Subclasses must define a client class for keeping state information
on the connected clients.</p>
<dl class="docutils">
<dt>Example usage::</dt>
<dd>server = SAPNIServer((local_host, local_port), handler_class)
server.client_cls = client_class
server.serve_forever()</dd>
</dl>
<dl class="attribute">
<dt id="pysap.SAPNI.SAPNIServer.clients_cls">
<code class="descname">clients_cls</code><a class="headerlink" href="#pysap.SAPNI.SAPNIServer.clients_cls" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Cvar:</th><td class="field-body">Client class for storing data about new clients</td>
</tr>
<tr class="field-even field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#pysap.SAPNI.SAPNIClient" title="pysap.SAPNI.SAPNIClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIClient</span></code></a> class</td>
</tr>
</tbody>
</table>
<p>alias of <a class="reference internal" href="#pysap.SAPNI.SAPNIClient" title="pysap.SAPNI.SAPNIClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIClient</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIServer.get_request">
<code class="descname">get_request</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIServer.get_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIServer.get_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap the socket object with a <a class="reference internal" href="#pysap.SAPNI.SAPNIStreamSocket" title="pysap.SAPNI.SAPNIStreamSocket"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIStreamSocket</span></code></a> after accepting
a connection.</p>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIServer.handle_error">
<code class="descname">handle_error</code><span class="sig-paren">(</span><em>request</em>, <em>client_address</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIServer.handle_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIServer.handle_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Called to handle an error or exception occurred with the server.</p>
</dd></dl>

<dl class="attribute">
<dt id="pysap.SAPNI.SAPNIServer.options">
<code class="descname">options</code><em class="property"> = None</em><a class="headerlink" href="#pysap.SAPNI.SAPNIServer.options" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Ivar:</th><td class="field-body">Options to pass to the request handler</td>
</tr>
<tr class="field-even field"><th class="field-name">Type:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">object</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIServer.shutdown_request">
<code class="descname">shutdown_request</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIServer.shutdown_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIServer.shutdown_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Called to shutdown and close an individual request.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pysap.SAPNI.SAPNIServerHandler">
<em class="property">class </em><code class="descclassname">pysap.SAPNI.</code><code class="descname">SAPNIServerHandler</code><span class="sig-paren">(</span><em>request</em>, <em>client_address</em>, <em>server</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIServerHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIServerHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SocketServer.BaseRequestHandler</span></code></p>
<p>SAP NI Server Handler</p>
<p>Handles <a class="reference internal" href="#pysap.SAPNI.SAPNI" title="pysap.SAPNI.SAPNI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNI</span></code></a> packets coming from a <a class="reference internal" href="#pysap.SAPNI.SAPNIServer" title="pysap.SAPNI.SAPNIServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIServer</span></code></a>.</p>
<dl class="method">
<dt id="pysap.SAPNI.SAPNIServerHandler.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIServerHandler.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIServerHandler.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close a client connection and deletes the client from the state
information on the server.</p>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIServerHandler.handle">
<code class="descname">handle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIServerHandler.handle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIServerHandler.handle" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a client connection. The handler assumes the client connection
is a <a class="reference internal" href="#pysap.SAPNI.SAPNIStreamSocket" title="pysap.SAPNI.SAPNIStreamSocket"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIStreamSocket</span></code></a> object. After received a <a class="reference internal" href="#pysap.SAPNI.SAPNI" title="pysap.SAPNI.SAPNI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNI</span></code></a> packet, it
stores it on the ‘packet’ instance variable and pass the control to the
handle_data method.</p>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIServerHandler.handle_data">
<code class="descname">handle_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIServerHandler.handle_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIServerHandler.handle_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle the data coming from the client. The <a class="reference internal" href="#pysap.SAPNI.SAPNI" title="pysap.SAPNI.SAPNI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNI</span></code></a> packet is stored
on data and client information on client_address instance variables.
Stub method to be overloaded in subclasses.</p>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIServerHandler.setup">
<code class="descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIServerHandler.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIServerHandler.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup a new client connection. Creates a new client object for
keeping state information of each client on the server instance.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pysap.SAPNI.SAPNIServerThreaded">
<em class="property">class </em><code class="descclassname">pysap.SAPNI.</code><code class="descname">SAPNIServerThreaded</code><span class="sig-paren">(</span><em>server_address</em>, <em>RequestHandlerClass</em>, <em>bind_and_activate=True</em>, <em>socket_cls=None</em>, <em>keep_alive=True</em>, <em>base_cls=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIServerThreaded"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIServerThreaded" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SocketServer.ThreadingMixIn</span></code>, <a class="reference internal" href="#pysap.SAPNI.SAPNIServer" title="pysap.SAPNI.SAPNIServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">pysap.SAPNI.SAPNIServer</span></code></a></p>
<p>A SAP NI Server implementation using threading</p>
</dd></dl>

<dl class="class">
<dt id="pysap.SAPNI.SAPNIStreamSocket">
<em class="property">class </em><code class="descclassname">pysap.SAPNI.</code><code class="descname">SAPNIStreamSocket</code><span class="sig-paren">(</span><em>sock</em>, <em>keep_alive=True</em>, <em>base_cls=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIStreamSocket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIStreamSocket" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">scapy.supersocket.StreamSocket</span></code></p>
<p>Stream socket implementation of the SAP Network Interface (NI) layer.</p>
<dl class="attribute">
<dt id="pysap.SAPNI.SAPNIStreamSocket.desc">
<code class="descname">desc</code><em class="property"> = 'NI Stream socket'</em><a class="headerlink" href="#pysap.SAPNI.SAPNIStreamSocket.desc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="pysap.SAPNI.SAPNIStreamSocket.get_nisocket">
<em class="property">classmethod </em><code class="descname">get_nisocket</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIStreamSocket.get_nisocket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIStreamSocket.get_nisocket" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to obtain a <a class="reference internal" href="#pysap.SAPNI.SAPNIStreamSocket" title="pysap.SAPNI.SAPNIStreamSocket"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIStreamSocket</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>host</strong> (<em>C{string}</em>) – host to connect to</li>
<li><strong>port</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – port to connect to</li>
<li><strong>kwargs</strong> – arguments to pass to <a class="reference internal" href="#pysap.SAPNI.SAPNIStreamSocket" title="pysap.SAPNI.SAPNIStreamSocket"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIStreamSocket</span></code></a> constructor</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">connected socket</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="#pysap.SAPNI.SAPNIStreamSocket" title="pysap.SAPNI.SAPNIStreamSocket"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNIStreamSocket</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>socket.error</strong> – if the connection to the target host/port failed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIStreamSocket.recv">
<code class="descname">recv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIStreamSocket.recv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIStreamSocket.recv" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive a packet at the NI layer, first reading the length field and
the reading the data. If the stream is waiting for a new packet and
the remote peer sends a keep-alive request (<a class="reference internal" href="#pysap.SAPNI.SAPNI.SAPNI_PING" title="pysap.SAPNI.SAPNI.SAPNI_PING"><code class="xref py py-class docutils literal notranslate"><span class="pre">NI_PING</span></code></a>),
the receive method will respond with a keep-alive response
(<a class="reference internal" href="#pysap.SAPNI.SAPNI.SAPNI_PONG" title="pysap.SAPNI.SAPNI.SAPNI_PONG"><code class="xref py py-class docutils literal notranslate"><span class="pre">NI_PONG</span></code></a>) to keep the communication stable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">received <a class="reference internal" href="#pysap.SAPNI.SAPNI" title="pysap.SAPNI.SAPNI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNI</span></code></a> packet</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pysap.SAPNI.SAPNI" title="pysap.SAPNI.SAPNI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNI</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><strong>socket.error</strong> – if the connection was close</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIStreamSocket.send">
<code class="descname">send</code><span class="sig-paren">(</span><em>packet</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIStreamSocket.send"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIStreamSocket.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a packet at the NI layer, prepending the length field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>packet</strong> (<em>Packet</em>) – packet to send</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pysap.SAPNI.SAPNIStreamSocket.sr">
<code class="descname">sr</code><span class="sig-paren">(</span><em>packet</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysap/SAPNI.html#SAPNIStreamSocket.sr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysap.SAPNI.SAPNIStreamSocket.sr" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a given packet and receive the response. Wrapper around the send
and receive methods. The response packet is build in the <a class="reference internal" href="#pysap.SAPNI.SAPNI" title="pysap.SAPNI.SAPNI"><code class="xref py py-class docutils literal notranslate"><span class="pre">SAPNI</span></code></a> layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>packet</strong> (<em>Packet</em>) – packet to send</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">packet received</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Packet</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pysap</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/index.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fileformats/index.html">File formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Example scripts</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">Development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Interface</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pysap.html">pysap package</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pysap.html#pysap">pysap</a></li>
<li class="toctree-l3"><a class="reference internal" href="pysap.html#subpackages">Subpackages</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="pysap.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pysapcompress.html">pysapcompress library</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Developer Interface</a><ul>
  <li><a href="pysap.html">pysap package</a><ul>
      <li>Previous: <a href="pysap.SAPMS.html" title="previous chapter">pysap.SAPMS module</a></li>
      <li>Next: <a href="pysap.SAPPSE.html" title="next chapter">pysap.SAPPSE module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;SECUREAUTH LABS. Copyright (C) 2019 SecureAuth Corporation. All rights reserved..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.9</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/api/pysap.SAPNI.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>